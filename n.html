<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Grow a Garden Auto Notif</title>
</head>
<body>
  <h2>üå± Grow a Garden Auto Notif ke Discord</h2>
  <div id="status">‚è≥ Menunggu update...</div>

  <script>
    const webhookUrl = "https://discord.com/api/webhooks/1414058721637564580/yr1FG_SmaWsQvOUBjCuMvSfHulCdtel9UeRAiKyzOCFpf6PNRpZGGxg_UlWrcBsnUn0g";

    async function kirimDiscord(pesan) {
      await fetch(webhookUrl, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ content: pesan })
      });
    }

    async function cekStock() {
      try {
        let res = await fetch("https://api.joshlei.com/v2/growagarden/stock", {
          headers: {
            "jstudio-key": "js_897f8e78e36d7f1f719c780031fede663b3f8406b94a7b6ab15c9174703ec735"
          }
        });
        let data = await res.json();

        if (data.seed_stock || data.gear_stock) {
          let pesan = "üå± **Stock Update**\n";
          if (data.seed_stock) {
            pesan += "\n**Seed Stock:**\n";
            data.seed_stock.forEach(item => {
              pesan += `- ${item.display_name} (Qty: ${item.quantity})\n`;
            });
          }
          if (data.gear_stock) {
            pesan += "\n‚öôÔ∏è **Gear Stock:**\n";
            data.gear_stock.forEach(item => {
              pesan += `- ${item.display_name} (Qty: ${item.quantity})\n`;
            });
          }
          await kirimDiscord(pesan);
          document.getElementById("status").textContent = "‚úÖ Notif terkirim ke Discord!";
        } else {
          document.getElementById("status").textContent = "‚ö†Ô∏è Data stock kosong";
        }
      } catch (err) {
        document.getElementById("status").textContent = "‚ùå Error: " + err.message;
      }
    }

    // auto cek setiap 5 menit
    cekStock(); // pertama kali jalan
    setInterval(cekStock, 5 * 60 * 1000);
  </script>
</body>
</html>
